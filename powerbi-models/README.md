# Power BI Models - Modern Data Stack Showcase

## Overview

This directory contains a comprehensive Power BI semantic modeling implementation showcasing enterprise-grade **Master Model Pattern** with **perspective-based architecture**. The implementation demonstrates advanced TMDL (Tabular Model Definition Language) patterns, automated child model generation, and systematic nomenclature transformations.

## ğŸ—ï¸ **Architecture Highlights**

### **Perspective-Based Child Model Generation**
- **Developer Perspectives** (`$harmonized`, `$grocery_connector`, `$retail_connector`) define which objects are included in each model
- **Automated Build Scripts** generate child models by filtering objects based on perspective membership
- **Systematic Transformations** during build process (Productâ†’Item, Storeâ†’Location for grocery connector)

### **Master Model Pattern**
- **Single Source of Truth**: All business logic maintained in one master model
- **Automated Consistency**: Systematic transformations ensure accurate renaming across all objects
- **DAX Expression Safety**: Measure expressions automatically updated for each connector
- **Performance Optimized**: No runtime translation overhead

## ğŸ“ **Directory Structure**

```
powerbi-models/
â”œâ”€â”€ README.md                           # This overview document
â”œâ”€â”€ ARCHITECTURE_INNOVATIONS.md         # Advanced architectural patterns and innovations
â”œâ”€â”€ azure-pipelines.yml                # CI/CD pipeline for automated deployment
â”œâ”€â”€ master-model/                       # Master model implementation
â”‚   â”œâ”€â”€ README.md                       # Detailed master model documentation
â”‚   â”œâ”€â”€ model-folder/                   # TMDL model files
â”‚   â”‚   â”œâ”€â”€ database.tmdl               # Database definition
â”‚   â”‚   â”œâ”€â”€ model.tmdl                  # Model with perspectives
â”‚   â”‚   â”œâ”€â”€ expressions.tmdl            # Shared expressions
â”‚   â”‚   â”œâ”€â”€ relationships.tmdl          # Star schema relationships
â”‚   â”‚   â”œâ”€â”€ perspectives/               # Developer perspectives
â”‚   â”‚   â”‚   â”œâ”€â”€ $harmonized.tmdl        # Cross-connector harmonized model
â”‚   â”‚   â”‚   â”œâ”€â”€ $grocery_connector.tmdl # Grocery-specific model (Item/Location)
â”‚   â”‚   â”‚   â””â”€â”€ $retail_connector.tmdl  # Retail-specific model (Product/Store)
â”‚   â”‚   â””â”€â”€ tables/                     # Table definitions
â”‚   â”‚       â”œâ”€â”€ Fact Sales.tmdl
â”‚   â”‚       â”œâ”€â”€ Fact Inventory.tmdl
â”‚   â”‚       â”œâ”€â”€ Dim Product.tmdl
â”‚   â”‚       â”œâ”€â”€ Dim Store.tmdl
â”‚   â”‚       â”œâ”€â”€ Dim Calendar.tmdl
â”‚   â”‚       â””â”€â”€ Dim Time Period.tmdl
â”‚   â””â”€â”€ scripts/                        # Child model generation
â”‚       â”œâ”€â”€ deploy-child-models.ps1     # PowerShell deployment script
â”‚       â”œâ”€â”€ deploy-child-models.bat     # Batch deployment script
â”‚       â””â”€â”€ child-models/               # Child model scripts
â”‚           â”œâ”€â”€ $harmonized.csx
â”‚           â”œâ”€â”€ $grocery_connector.csx
â”‚           â””â”€â”€ $retail_connector.csx
â”œâ”€â”€ shared-assets/                      # Shared components
â”‚   â”œâ”€â”€ themes/                         # Power BI themes
â”‚   â”œâ”€â”€ templates/                      # DAX templates
â”‚   â””â”€â”€ documentation/                  # Technical guides
â”œâ”€â”€ devops-templates/                   # DevOps automation
â”‚   â”œâ”€â”€ azure-pipelines/                # Pipeline templates
â”‚   â””â”€â”€ scripts/                        # Deployment automation
â””â”€â”€ deployment/                         # Deployment configurations
    â”œâ”€â”€ environments/                   # Environment-specific configs
    â””â”€â”€ validation/                     # Model validation scripts
```

## ğŸ¯ **Key Features**

### **Perspective-Based Architecture**
- **Explicit Object Inclusion**: Each perspective explicitly defines which tables, measures, and columns are included
- **Clean Separation**: No complex annotation logic - simple perspective membership determines inclusion
- **Dependency Management**: Automatic handling of object dependencies during child model generation
- **Build-Time Filtering**: Child models generated by removing objects not in perspective

### **Systematic Nomenclature Transformation**
- **Grocery Connector**: Productâ†’Item, Storeâ†’Location transformation across all objects
- **Retail Connector**: Standard Product/Store nomenclature maintained
- **Harmonized Model**: Cross-connector standardized schema with consistent naming
- **Automated Renaming**: Table names, column names, and DAX expressions automatically updated

### **Enterprise-Grade Star Schema**
- **Fact Tables**: Sales and Inventory with comprehensive measure libraries
- **Dimension Tables**: Product, Store, Calendar, Time Period with rich attributes
- **Optimized Relationships**: Star schema with proper cardinality and performance optimization
- **Advanced Time Intelligence**: Monday-start weeks, fiscal calendars, relative periods

### **Comprehensive Measure Library**
- **Sales Measures**: Amount, Quantity, Average Selling Price, Transaction Count
- **Inventory Measures**: On Hand, Available, Allocated, Inventory Turns
- **Grocery-Specific**: Regular/Promotional sales, spoilage tracking, perishable flags
- **Retail-Specific**: Brand tiers, seasonal flags, product hierarchies
- **Consistent Formatting**: Standardized number formats and display folders

## ğŸš€ **Getting Started**

### **Prerequisites**
- **Tabular Editor 3** (latest version)
- **Power BI Desktop** (latest version)
- **PowerShell 5.0+** (for deployment scripts)

### **Quick Start**

1. **Open Master Model**:
   ```bash
   TabularEditor3.exe "master-model/model-folder"
   ```

2. **View Perspectives**:
   - Switch between `$harmonized`, `$grocery_connector`, `$retail_connector` perspectives
   - Each perspective shows only the objects included in that specific model

3. **Generate Child Models**:
   ```powershell
   cd master-model/scripts
   .\deploy-child-models.ps1
   ```

4. **Deploy to Server**:
   ```powershell
   # Deploy all models to Analysis Services
   .\deploy-child-models.ps1 -ServerName "localhost" -Deploy
   ```

## ğŸ”§ **Development Workflow**

### **Adding New Objects**

1. **Create in Master Model**: Add tables, measures, or columns to the master model
2. **Assign to Perspectives**: Use Tabular Editor to assign objects to appropriate perspectives
3. **Test Perspectives**: Switch between perspectives to verify object visibility
4. **Generate Child Models**: Run deployment scripts to create updated child models

### **Modifying Existing Objects**

1. **Update Master Model**: Make changes to tables, measures, or relationships
2. **Update Perspectives**: Adjust perspective assignments if needed
3. **Test Each Perspective**: Verify functionality across all perspectives
4. **Deploy Updates**: Generate and deploy updated child models

### **Adding New Connectors**

1. **Create New Perspective**: Add new `$new_connector` perspective
2. **Assign Objects**: Define which objects belong to the new connector
3. **Create Child Script**: Develop new `.csx` script for the connector
4. **Update Deployment**: Modify deployment scripts to include new connector

## ğŸ“Š **Model Specifications**

### **Data Model**
- **Tables**: 6 core tables (2 facts, 4 dimensions)
- **Measures**: 23 comprehensive measures with proper formatting
- **Relationships**: Optimized star schema with single-direction relationships
- **Partitions**: Connector-specific data source configurations

### **Connector Variations**
- **Harmonized**: Cross-connector standardized schema
- **Grocery**: Item/Location nomenclature with perishable tracking
- **Retail**: Product/Store nomenclature with brand hierarchies

### **Performance Optimization**
- **Integer Keys**: Optimized for compression and performance
- **Proper Data Types**: Minimize memory usage and improve query speed
- **Star Schema**: Denormalized design for optimal query performance
- **Relationship Optimization**: Single-direction relationships where possible

## ğŸ› ï¸ **Advanced Features**

### **Time Intelligence**
- **Dim Calendar**: Complete date dimension with Monday-start weeks
- **Dim Time Period**: Dynamic periods based on current date
- **Fiscal Calendar**: Configurable fiscal year support
- **Relative Periods**: Last N weeks, YTD, MTD, QTD calculations

### **Data Source Management**
- **BigQuery Integration**: Optimized for Google BigQuery connections
- **Connection Strings**: Environment-specific data source configurations
- **Incremental Refresh**: Configured for large-scale data processing
- **Security**: Service account authentication and row-level security

### **DevOps Integration**
- **Azure DevOps**: Complete CI/CD pipeline templates
- **Automated Testing**: Model validation and DAX syntax checking
- **Multi-Environment**: Dev, staging, production deployment workflows
- **Quality Gates**: Performance testing and validation checks

## ğŸ“š **Documentation**

- **[Master Model README](master-model/README.md)**: Detailed implementation guide
- **[Architecture Innovations](ARCHITECTURE_INNOVATIONS.md)**: Advanced architectural patterns
- **[Azure Pipelines](azure-pipelines.yml)**: CI/CD configuration and deployment
- **[Shared Assets](shared-assets/README.md)**: Themes, templates, and utilities

## ğŸ¯ **Benefits of This Approach**

### **âœ… Developer Experience**
- **Single Source of Truth**: All logic maintained in one place
- **Perspective-Based Clarity**: Clear visibility of what's included in each model
- **Automated Consistency**: No manual find-and-replace errors
- **Systematic Transformations**: Intelligent renaming across all objects

### **âœ… Operational Excellence**
- **Automated Deployment**: Complete CI/CD pipeline integration
- **Quality Assurance**: Automated testing and validation
- **Performance Optimization**: Build-time optimizations and best practices
- **Scalable Architecture**: Supports multiple connectors and environments

### **âœ… Maintenance Benefits**
- **Reduced Complexity**: Perspectives eliminate annotation complexity
- **Version Control**: Clean diffs and better change tracking
- **Testing Isolation**: Test each connector independently
- **Parallel Development**: Multiple teams can work on different connectors

## ğŸ”„ **Integration with Modern Data Stack**

This Power BI implementation integrates seamlessly with the broader Modern Data Stack Showcase:

- **DBT Analytics**: Consumes data from dbt models in the analytics layer
- **Data Pipeline**: Connects to the data pipeline output tables
- **Infrastructure**: Deployed using the infrastructure automation platform
- **Monitoring**: Integrated with the comprehensive monitoring stack
- **Security**: Follows the security governance framework

## ğŸ“ˆ **Future Enhancements**

- **Additional Connectors**: Expand to more retail and grocery connectors
- **Advanced Analytics**: Machine learning integration and predictive measures
- **Real-Time Data**: Streaming data integration and real-time dashboards
- **Enhanced Governance**: Data lineage, impact analysis, and audit trails
- **User Experience**: Custom visuals, mobile optimization, and interactive reports

---

**ğŸ“– For detailed implementation guides, see the [Master Model README](master-model/README.md)**

**ğŸ—ï¸ For architectural innovations and patterns, see [ARCHITECTURE_INNOVATIONS.md](ARCHITECTURE_INNOVATIONS.md)** 